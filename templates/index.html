<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webspark Tag Analyzer</title>
    <!-- Link all your CSS files -->
    <link rel="stylesheet" href="/static/base.css">
    <link rel="stylesheet" href="/static/header.css">
    <link rel="stylesheet" href="/static/analyzer-form.css">
    <link rel="stylesheet" href="/static/stream.css">
    <link rel="stylesheet" href="/static/results.css">
    <link rel="stylesheet" href="/static/footer.css">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Fixed background -->
    <div class="background-wrapper">
        <img src="/static/images/space-background.webp" alt="" class="background-image">
    </div>

    <!-- Main content -->
    <div class="main-content">
        {% include 'partials/header.html' %}

        <!-- === MODIFIED HERO SECTION START === -->
        <section class="hero-section">
            <div class="hero-content-left">
                <h1 class="hero-title">Webspark<br>Tag Analyzer</h1>
                <p class="hero-subtitle">Analyze any URL. Visualize tags, track events, and optimize performance — all in one tool built for developers and marketers.</p>

                <form id="analyze-form" class="url-form">
                    <input
                        id="url" 
                        type="text"
                        placeholder="Enter URL to analyze"
                        value="https://www.penguinrandomhouse.com/books/704944/happy-place-by-emily-henry/"
                        class="url-input">
                    <button class="analyze-button">
                        Analyze ⚡
                    </button>
                </form>
            </div>
        </section>
        <!-- === MODIFIED HERO SECTION END === -->

        <!-- Analysis section with terminal -->
        <section class="analysis-section">
            <div class="analysis-card">
                <div class="card-header">
                    <h2><i class="fas fa-terminal"></i> Analysis Engine</h2>
                    <div class="status-badge" id="analysis-status">Waiting to start</div>
                </div>
                <div class="card-body">
                    <div class="analysis-layout">
                        <!-- Analysis Element -->
                        <div class="ai-agent-element">
                            <div class="ai-agent-circle">
                                <!-- Orb image is background -->
                            </div>
                        </div>

                        <!-- Analyzing Label -->
                        <div class="analyzing-label">ANALYZING TAG PERFORMANCE</div>

                        <!-- Container for Stages and Log (side-by-side) -->
                        <div class="stages-and-log-container">
                            <div class="analysis-left"> <!-- Stages -->
                                <div class="stages-container">
                                     <!-- Stage: Initialization -->
                                    <div class="stage pending" id="stage-setup">
                                        <div class="stage-icon"><i class="fas fa-rocket"></i></div>
                                        <div class="stage-label">INITIALIZATION</div>
                                    </div>
                                    <!-- Stage: Page Load -->
                                    <div class="stage pending" id="stage-loading">
                                        <div class="stage-icon"><i class="fas fa-globe"></i></div>
                                        <div class="stage-label">PAGE LOAD</div>
                                    </div>
                                    <!-- Stage: Data Collection -->
                                    <div class="stage pending" id="stage-data">
                                        <div class="stage-icon"><i class="fas fa-database"></i></div>
                                        <div class="stage-label">DATA COLLECTION</div>
                                    </div>
                                    <!-- Stage: Completion -->
                                    <div class="stage pending" id="stage-complete">
                                        <div class="stage-icon"><i class="fas fa-check"></i></div>
                                        <div class="stage-label">COMPLETION</div>
                                    </div>
                                </div>
                            </div>

                            <div class="analysis-right"> <!-- Log -->
                                <div class="live-log-panel" id="live-log-panel">
                                    <div class="live-log-content-wrapper">
                                        <div class="live-log-header">LIVE LOG</div>
                                        <ul id="live-log-list" class="live-log-messages">
                                            <!-- Log items here -->
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Loading Animation (Keep as is) -->
                    <div id="loading" class="loading-container" style="display: none;">
                        <div class="loading-animation">
                            <div class="loading-circle"></div>
                            <div class="loading-circle"></div>
                            <div class="loading-circle"></div>
                            <div class="loading-pulse"></div>
                        </div>
                        <div class="loading-text">Processing</div>
                    </div>

                    <!-- Error Message Container (Keep as is) -->
                    <div id="error-message" class="error-message"></div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section class="results-section">
            <div class="results-card expandable" id="results-card">
                <div class="card-header toggle-expand">
                    <h2><i class="fas fa-chart-pie"></i> Analysis Results</h2>
                    <div class="card-controls">
                        <button id="copy-results" class="btn-icon" title="Copy results">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button id="toggle-expand-btn" class="btn-icon" title="Expand/Collapse">
                            <i class="fas fa-expand-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="results-container" class="results-container">
                        <div class="results-tabs">
                            <button class="tab-button active" data-tab="summary-tab">Summary</button>
                            <button class="tab-button" data-tab="pageview-tab">Page View</button>
                            <button class="tab-button" data-tab="click-events-tab">Click Events</button>
                            <button class="tab-button" data-tab="visual-tab">Visualization</button>
                        </div>

                        <div class="tab-content">
                            <div id="summary-tab" class="tab-pane active">
                                <div class="section-header">
                                    <i class="fas fa-chart-bar"></i> Analysis Summary
                                </div>
                                <pre id="results-pre"></pre>
                            </div>
                            <div id="pageview-tab" class="tab-pane">
                                <div class="section-header">
                                    <i class="fas fa-eye"></i> Page View Data
                                </div>
                                <div id="pageview-data-content">
                                    <!-- Page view data will be populated here by JS -->
                                    <table class="event-table" id="utag-data-table">
                                        <thead>
                                            <tr>
                                                <th>Data Key</th>
                                                <th>Value</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- utag_data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div id="click-events-tab" class="tab-pane">
                                <div class="section-header">
                                    <i class="fas fa-mouse-pointer"></i> Click Events
                                </div>
                                <!-- NEW Structure for Click Events Tab -->
                                <div id="event-type-tabs" class="event-type-tabs">
                                    <!-- Event type sub-tabs will be generated here by JS -->
                                </div>
                                <div id="event-type-content" class="event-type-content">
                                    <!-- Expandable table for the selected event type will be generated here by JS -->
                                </div>
                            </div>
                            <div id="visual-tab" class="tab-pane">
                                <div id="visualization-area">
                                    <p>Advanced visualization could be implemented here with D3.js or Chart.js</p>
                                    <p>Consider visualizing:</p>
                                    <ul>
                                        <li>• Tag distribution by category</li>
                                        <li>• Network request timeline</li>
                                        <li>• Event flow diagram</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="download-container">
                            <a id="download-json" href="#" download="analysis_results.json" class="btn-secondary">
                                <i class="fas fa-download"></i> Download Results
                            </a>
                        </div>
                    </div>

                    <!-- Empty state (shown before first analysis) -->
                    <div class="results-empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 class="empty-state-title">No Analysis Results Yet</h3>
                        <p class="empty-state-message">
                            Enter a URL above and click Analyze to see detailed results about the page's tags and tracking.
                        </p>
                        <p class="empty-state-message">
                            The Page View tab will display all <code>utag_data</code> variables found during initial page load.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Notification for Copy Success -->
        <div id="notification" class="notification">
            <div class="notification-icon"><i class="fas fa-check-circle"></i></div>
            <div class="notification-content">Copied to clipboard!</div>
        </div>

        <!-- Enhanced Footer Section -->
        <footer class="app-footer">

            <!-- Footer Navigation -->
            <nav class="footer-nav">
                <a href="#" class="footer-nav-link">Home</a>
                <a href="#" class="footer-nav-link">Documentation</a>
                <a href="#" class="footer-nav-link">About</a>
                <a href="#" class="footer-nav-link">Privacy Policy</a>
                <a href="#" class="footer-nav-link">Terms of Service</a>
            </nav>

            <!-- Copyright -->
            <p> 2025 Webspark Tag Analyzer | All rights reserved</p>

            <!-- Attribution (Optional) -->
            <div class="attribution">
                Made with <i class="fas fa-heart" style="color: #ef4444;"></i> for web developers
            </div>

            <!-- Visual Effects (Ensure CSS handles these) -->
            <div class="footer-wave"></div>
            <div class="star-field">
                <!-- Stars generated via JavaScript -->
            </div>
        </footer>

        <!-- Star Generation Script (already present) -->
        <script>
        document.addEventListener('DOMContentLoaded', function() {
            const starField = document.querySelector('.star-field');
            if (starField) {
                for (let i = 0; i < 50; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');
                    star.style.left = `${Math.random() * 100}%`;
                    star.style.top = `${Math.random() * 100}%`;
                    star.style.animationDelay = `${Math.random() * 4}s`;
                    starField.appendChild(star);
                }
            }
        });
        </script>

    </div> <!-- End Main Content -->

    <script src="/static/scripts.js"></script>
</body>
</html>
