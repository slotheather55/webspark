<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webspark Macro Recorder</title>
    <!-- Link all your CSS files -->
    <link rel="stylesheet" href="/static/base.css">
    <link rel="stylesheet" href="/static/header.css">
    <link rel="stylesheet" href="/static/analyzer-form.css">
    <link rel="stylesheet" href="/static/stream.css">
    <link rel="stylesheet" href="/static/results.css">
    <link rel="stylesheet" href="/static/footer.css">
    <link rel="stylesheet" href="/static/macros.css">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Fixed background -->
    <div class="background-wrapper">
        <img src="/static/images/space-background.webp" alt="" class="background-image">
    </div>

    <!-- Main content -->
    <div class="main-content">
        <header class="app-header">
            <div class="logo-container">
                <div class="logo-icon">
                    <!-- SVG Logo -->
                    <svg viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M24.0428 14.1428C23.9006 14.0007 23.7194 13.9072 23.5233 13.8718C23.3273 13.8365 23.1255 13.8607 22.9429 13.9414C22.7603 14.0221 22.6055 14.1558 22.4981 14.3255C22.3908 14.4952 22.3357 14.6933 22.3399 14.8942C22.5201 20.1057 18.2999 21.3828 16.4399 21.7828C12.9656 22.44 9.2399 19.4171 8.8799 19.1085C8.7377 18.9664 8.5566 18.8729 8.3605 18.8375C8.1645 18.8022 7.96267 18.8264 7.78008 18.9071C7.59749 18.9878 7.44265 19.1215 7.33534 19.2912C7.22802 19.4609 7.17291 19.659 7.17711 19.8599C7.17711 22.0828 8.5599 24.6514 11.3199 26.28C12.3646 26.9035 13.559 27.2615 14.7799 27.3199C15.0613 27.3199 15.3399 27.3199 15.6228 27.2771C19.7342 26.7214 23.2399 23.6985 23.7942 19.5599C24.0542 17.4428 24.2399 15.4114 24.0428 14.1428Z" fill="#4f79ff"/>
                        <path d="M19.1999 9.2399C19.3421 9.38205 19.5232 9.47555 19.7193 9.51088C19.9154 9.54622 20.1172 9.52208 20.2998 9.44137C20.4824 9.36067 20.6372 9.22698 20.7446 9.05727C20.8519 8.88756 20.907 8.68949 20.9028 8.4885C20.7227 3.277 24.9429 1.99992 26.8028 1.59992C30.2828 0.942775 34.0028 3.96564 34.3628 4.27421C34.505 4.41636 34.6861 4.50986 34.8822 4.5452C35.0782 4.58053 35.28 4.55639 35.4626 4.47569C35.6452 4.39498 35.8001 4.26129 35.9074 4.09158C36.0147 3.92188 36.0698 3.7238 36.0656 3.52281C36.0656 1.29992 34.6828 -1.26865 31.9228 -2.8972C30.8781 -3.52066 29.6837 -3.87871 28.4628 -3.9372C28.1814 -3.9372 27.9028 -3.9372 27.6199 -3.89435C23.5142 -3.3372 20.0028 -0.3143 19.4485 3.7743C19.1885 5.89136 19.0028 7.92279 19.1999 9.2399Z" fill="#4f79ff"/>
                        <path d="M11.9599 14.3143C12.1021 14.1722 12.2832 14.0787 12.4793 14.0433C12.6754 14.008 12.8772 14.0321 13.0598 14.1128C13.2424 14.1935 13.3972 14.3272 13.5045 14.4969C13.6119 14.6666 13.667 14.8647 13.6628 15.0657C13.4827 20.2771 17.7028 21.5543 19.5628 21.9543C23.0428 22.6114 26.7685 19.5886 27.1285 19.28C27.2707 19.1378 27.4518 19.0443 27.6479 19.009C27.844 18.9737 28.0458 18.9978 28.2284 19.0785C28.411 19.1592 28.5658 19.2929 28.6731 19.4626C28.7804 19.6323 28.8355 19.8304 28.8313 20.0314C28.8313 22.2543 27.4485 24.8229 24.6885 26.4514C23.6439 27.075 22.4494 27.433 21.2285 27.4914C20.9471 27.4914 20.6685 27.4914 20.3856 27.4486C16.2742 26.8929 12.7685 23.87 12.2142 19.7314C11.9542 17.6143 11.7628 15.5829 11.9599 14.3143Z" fill="#4f79ff"/>
                        <path d="M16.8001 9.41137C16.6579 9.25922 16.4768 9.16572 16.2807 9.13039C16.0847 9.09505 15.8829 9.11919 15.7003 9.1999C15.5177 9.2806 15.3628 9.41429 15.2555 9.584C15.1482 9.75371 15.0931 9.95179 15.0972 10.1528C15.2774 15.3657 11.0572 16.6428 9.19725 17.0428C5.71725 17.7 1.99726 14.6771 1.63726 14.3685C1.49511 14.2264 1.31405 14.1329 1.11798 14.0975C0.921901 14.0622 0.720104 14.0863 0.537513 14.167C0.354922 14.2477 0.20008 14.3814 0.0927686 14.5511C-0.0145428 14.7208 -0.069648 14.9189 -0.0654505 15.1199C-0.0654505 17.3428 1.31726 19.9114 4.07726 21.54C5.12194 22.1635 6.31638 22.5215 7.53724 22.58C7.81867 22.58 8.09725 22.58 8.38011 22.5371C12.4915 21.9814 15.9972 18.9586 16.5515 14.82C16.8115 12.7028 17.0001 10.6714 16.8001 9.41137Z" fill="#4f79ff"/>
                    </svg>
                </div>
                <h1>Webspark</h1>
            </div>

            <nav class="nav-links">
                <a href="/" class="nav-link">Home</a>
                <a href="/record" class="nav-link active">Record</a>
                <a href="#" class="nav-link">Docs</a>
                <a href="#" class="nav-link">About</a>
                <button class="theme-toggle" aria-label="Toggle dark/light mode">
                    <i class="fas fa-moon"></i>
                </button>
            </nav>
        </header>

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content-left">
                <h1 class="hero-title">Macro<br>Recorder</h1>
                <p class="hero-subtitle">Record user interactions on any website and replay them as macros. Perfect for automated testing, user journey analysis, and workflow automation.</p>

                <form id="record-form" class="url-form">
                    <input
                        id="record-url" 
                        type="text"
                        placeholder="Enter URL to record interactions"
                        value="{{ default_url }}"
                        class="url-input">
                    <button type="button" id="start-recording" class="analyze-button">
                        <i class="fas fa-play"></i> Start Recording
                    </button>
                </form>
            </div>
        </section>

        <!-- Hidden fields for recording state -->
        <input type="hidden" id="macro-name" value="">
        <div id="action-count" style="display: none;">0</div>
        <div id="recording-time" style="display: none;">00:00</div>
        <div id="action-list" style="display: none;"></div>
        <div id="recording-status" style="display: none;">Ready to record</div>

        <!-- Browser Preview Section -->
        <section class="browser-section" id="browser-section" style="display: none;">
            <div class="browser-card">
                <div class="browser-header">
                    <div class="browser-controls">
                        <div class="browser-dots">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                        </div>
                        <div class="browser-url-bar" id="browser-url-display"></div>
                        <div class="browser-status" id="browser-status">Loading...</div>
                    </div>
                </div>
                <div class="browser-viewport" id="browser-viewport">
                    <div class="loading-placeholder">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading website...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Saved Macros Section -->
		<section class="results-section">
			<div class="results-card" id="macros-card">
				<div class="card-header">
					<h2><i class="fas fa-list"></i> Saved Macros</h2>
				</div>
                <div class="card-body">
                    <div id="macros-container" class="macros-container">
						<div class="macros-list" id="macros-list">
                            <div class="empty-state">
                                <i class="fas fa-folder-open"></i>
                                <h3>No Macros Saved Yet</h3>
                                <p>Record your first macro to see it here. Saved macros can be replayed, edited, and exported.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

		<!-- Macro Analysis Engine (same UI as homepage) -->
		<section class="analysis-section" id="macro-analysis-engine">
			<div class="analysis-card">
				<div class="card-header">
					<h2><i class="fas fa-terminal"></i> Analysis Engine</h2>
					<div class="status-badge" id="analysis-status">Waiting to start</div>
				</div>
				<div class="card-body">
					<div class="analysis-layout">
						<!-- Analysis Element -->
						<div class="ai-agent-element">
							<div class="ai-agent-circle"></div>
						</div>

						<!-- Analyzing Label -->
						<div class="analyzing-label">ANALYZING TAG PERFORMANCE</div>

						<!-- Container for Stages and Log (side-by-side) -->
						<div class="stages-and-log-container">
							<div class="analysis-left"> <!-- Stages -->
								<div class="stages-container">
									<!-- Stage: Initialization -->
									<div class="stage pending" id="stage-setup">
										<div class="stage-icon"><i class="fas fa-rocket"></i></div>
										<div class="stage-label">INITIALIZATION</div>
									</div>
									<!-- Stage: Page Load -->
									<div class="stage pending" id="stage-loading">
										<div class="stage-icon"><i class="fas fa-globe"></i></div>
										<div class="stage-label">PAGE LOAD</div>
									</div>
									<!-- Stage: Data Collection -->
									<div class="stage pending" id="stage-data">
										<div class="stage-icon"><i class="fas fa-database"></i></div>
										<div class="stage-label">DATA COLLECTION</div>
									</div>
									<!-- Stage: Completion -->
									<div class="stage pending" id="stage-complete">
										<div class="stage-icon"><i class="fas fa-check"></i></div>
										<div class="stage-label">COMPLETION</div>
									</div>
								</div>
							</div>

							<div class="analysis-right"> <!-- Log -->
								<div class="live-log-panel" id="live-log-panel">
									<div class="live-log-content-wrapper">
										<div class="live-log-header">LIVE LOG</div>
										<ul id="live-log-list" class="live-log-messages"></ul>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Loading Animation -->
					<div id="loading" class="loading-container" style="display: none;">
						<div class="loading-animation">
							<div class="loading-circle"></div>
							<div class="loading-circle"></div>
							<div class="loading-circle"></div>
							<div class="loading-pulse"></div>
						</div>
						<div class="loading-text">Processing</div>
					</div>

					<!-- Error Message Container -->
					<div id="error-message" class="error-message"></div>
				</div>
			</div>
		</section>

		<!-- Macro Analysis Results Section -->
		<section class="results-section">
			<div class="results-card expandable" id="results-card">
				<div class="card-header toggle-expand">
					<h2><i class="fas fa-chart-pie"></i> Analysis Results</h2>
					<div class="card-controls">
						<button id="copy-results" class="btn-icon" title="Copy results">
							<i class="fas fa-copy"></i>
						</button>
						<button id="toggle-expand-btn" class="btn-icon" title="Expand/Collapse">
							<i class="fas fa-expand-alt"></i>
						</button>
					</div>
				</div>
				<div class="card-body">
					<div id="results-container" class="results-container">
						<div class="results-tabs">
							<button class="tab-button active" data-tab="summary-tab">Summary</button>
							<button class="tab-button" data-tab="pageview-tab">Page View</button>
							<button class="tab-button" data-tab="click-events-tab">Click Events</button>
							<button class="tab-button" data-tab="visual-tab">Visualization</button>
						</div>

						<div class="tab-content">
							<div id="summary-tab" class="tab-pane active">
								<div class="section-header">
									<i class="fas fa-chart-bar"></i> Analysis Summary
								</div>
								<pre id="results-pre"></pre>
							</div>
							<div id="pageview-tab" class="tab-pane">
								<div class="section-header">
									<i class="fas fa-eye"></i> Page View Data
								</div>
								<div id="pageview-data-content">
									<table class="event-table" id="utag-data-table">
										<thead>
											<tr>
												<th>Data Key</th>
												<th>Value</th>
											</tr>
										</thead>
										<tbody></tbody>
									</table>
								</div>
							</div>
							<div id="click-events-tab" class="tab-pane">
								<div class="section-header">
									<i class="fas fa-mouse-pointer"></i> Click Events
								</div>
								<div id="event-type-tabs" class="event-type-tabs"></div>
								<div id="event-type-content" class="event-type-content"></div>
							</div>
							<div id="visual-tab" class="tab-pane">
								<div id="visualization-area"></div>
							</div>
						</div>

						<div class="download-container">
							<a id="download-json" href="#" download="analysis_results.json" class="btn-secondary">
								<i class="fas fa-download"></i> Download Results
							</a>
						</div>
					</div>

					<!-- Empty state (shown before first analysis) -->
					<div class="results-empty-state">
						<div class="empty-state-icon">
							<i class="fas fa-search"></i>
						</div>
						<h3 class="empty-state-title">No Analysis Results Yet</h3>
						<p class="empty-state-message">Use the Analyze button on a saved macro to run analysis and see results here.</p>
					</div>
				</div>
			</div>
		</section>

        <!-- Notification for actions -->
        <div id="notification" class="notification">
            <div class="notification-icon"><i class="fas fa-check-circle"></i></div>
            <div class="notification-content">Action recorded!</div>
        </div>

        <!-- Enhanced Footer Section -->
        <footer class="app-footer">
            <!-- Social Links -->
            <div class="footer-social">
                <a href="#" class="social-link" title="GitHub"><i class="fab fa-github"></i></a>
                <a href="#" class="social-link" title="Twitter"><i class="fab fa-twitter"></i></a>
                <a href="#" class="social-link" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
            </div>

            <!-- Footer Navigation -->
            <nav class="footer-nav">
                <a href="#" class="footer-nav-link">Home</a>
                <a href="#" class="footer-nav-link">Documentation</a>
                <a href="#" class="footer-nav-link">About</a>
                <a href="#" class="footer-nav-link">Privacy Policy</a>
                <a href="#" class="footer-nav-link">Terms of Service</a>
            </nav>

            <!-- Copyright -->
            <p> 2025 Webspark Macro Recorder | All rights reserved</p>

            <!-- Attribution -->
            <div class="attribution">
                Made with <i class="fas fa-heart" style="color: #ef4444;"></i> for automation enthusiasts
            </div>

            <!-- Visual Effects -->
            <div class="footer-wave"></div>
            <div class="star-field">
                <!-- Stars generated via JavaScript -->
            </div>
        </footer>

        <!-- Additional styles for recording controls -->
        <style>
            .control-button-danger {
                background: #dc3545 !important;
                border-color: #dc3545 !important;
                color: white !important;
            }
            
            .control-button-danger:hover:not(:disabled) {
                background: #c82333 !important;
                border-color: #bd2130 !important;
            }
            
            .control-button-danger:disabled {
                background: #6c757d !important;
                border-color: #6c757d !important;
                opacity: 0.5;
            }
            
            /* Action list improvements */
            .action-meta {
                display: flex;
                gap: 0.5rem;
                flex-wrap: wrap;
                margin-top: 0.5rem;
                align-items: flex-start;
            }
            
            .action-selector {
                background: #f1f3f4;
                color: #5f6368;
                padding: 4px 8px;
                border-radius: 3px;
                font-family: 'JetBrains Mono', monospace;
                font-size: 0.75rem;
                word-break: break-all;
                white-space: normal;
                cursor: help;
                line-height: 1.3;
                border: 1px solid #e1e5e9;
            }
            
            .action-type {
                background: #4f79ff;
                color: white;
                padding: 2px 6px;
                border-radius: 3px;
                font-size: 0.75rem;
                text-transform: uppercase;
                font-weight: 500;
                flex-shrink: 0;
            }
            
            .action-time {
                color: #666;
                font-size: 0.75rem;
                font-weight: 500;
                flex-shrink: 0;
            }
            
            /* Enhanced analyze button styling */
            .btn-analyze-primary {
                background: #28a745 !important;
                color: white !important;
                border: 2px solid #28a745 !important;
                padding: 0.5rem 1rem !important;
                font-weight: 600 !important;
                text-transform: uppercase !important;
                letter-spacing: 0.5px !important;
            }
            
            .btn-analyze-primary:hover {
                background: #218838 !important;
                border-color: #1e7e34 !important;
                transform: translateY(-1px) !important;
                box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3) !important;
            }
            
            /* Recording button states */
            .analyze-button.recording {
                background: linear-gradient(135deg, #dc3545, #e74c3c) !important;
                border-color: #dc3545 !important;
                animation: pulse-recording 2s infinite;
            }
            
            .analyze-button.recording:hover {
                background: linear-gradient(135deg, #c82333, #dc3545) !important;
                border-color: #bd2130 !important;
            }
            
            @keyframes pulse-recording {
                0%, 100% { box-shadow: 0 0 5px rgba(220, 53, 69, 0.3); }
                50% { box-shadow: 0 0 20px rgba(220, 53, 69, 0.7); }
            }
        </style>

        <!-- Star Generation Script -->
        <script>
        document.addEventListener('DOMContentLoaded', function() {
            const starField = document.querySelector('.star-field');
            if (starField) {
                for (let i = 0; i < 50; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');
                    star.style.left = `${Math.random() * 100}%`;
                    star.style.top = `${Math.random() * 100}%`;
                    star.style.animationDelay = `${Math.random() * 4}s`;
                    starField.appendChild(star);
                }
            }
        });
        </script>

    </div>

    <!-- Import the main recorder script -->
    <script src="/static/recorder.js"></script>
</body>
</html>